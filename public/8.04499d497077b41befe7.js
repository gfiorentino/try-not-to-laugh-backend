(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{Ev8k:function(e,t,n){"use strict";n.r(t),n.d(t,"CameraDetectionModule",function(){return b});var i=n("ofXK"),o=n("tyNb"),s=n("mrSG"),a=n("qzk7"),r=n("fXoL"),c=n("Xa2L");const d=["video"],l=["canvas"];function u(e,t){1&e&&r.Jb(0,"mat-spinner")}const m=[{path:"",component:(()=>{class e{constructor(e){this.cdr=e,this.loading=!1}ngOnDestroy(){this.stream&&this.stream.getTracks().forEach(e=>e.stop())}ngAfterViewInit(){this.run()}run(){return Object(s.a)(this,void 0,void 0,function*(){const e=(document.getElementsByTagName("base")[0]||{}).href;let t="/assets/weights/";e&&(t=e+t.substring(1)),this.loading=!0,this.cdr.detectChanges(),yield Promise.all([a.e.tinyFaceDetector.loadFromUri(t),a.e.faceRecognitionNet.loadFromUri(t),a.e.faceExpressionNet.loadFromUri(t)]),this.loading=!1,this.cdr.detectChanges(),this.stream=yield navigator.mediaDevices.getUserMedia({video:{}}),this.video.nativeElement.srcObject=this.stream})}onPlay(){return Object(s.a)(this,void 0,void 0,function*(){const e=this.video.nativeElement,t=this.canvas.nativeElement;if(e.paused||e.ended||!a.e.tinyFaceDetector.params)return requestAnimationFrame(()=>this.onPlay());const n=yield a.b(e,new a.a).withFaceExpressions();if(console.log("detectSingleFace",null==n?void 0:n.expressions),n){t.style.display="block";const i=a.d(t,e,!0),o=a.f(n,i),s=.05;a.c.drawDetections(t,o),a.c.drawFaceExpressions(t,o,s)}else t.style.display="none";requestAnimationFrame(()=>this.onPlay())})}}return e.\u0275fac=function(t){return new(t||e)(r.Ib(r.h))},e.\u0275cmp=r.Cb({type:e,selectors:[["app-camera-detection"]],viewQuery:function(e,t){if(1&e&&(r.hc(d,!0),r.hc(l,!0)),2&e){let e;r.Zb(e=r.Tb())&&(t.video=e.first),r.Zb(e=r.Tb())&&(t.canvas=e.first)}},decls:6,vars:1,consts:[[4,"ngIf"],[1,"video-container"],["autoplay","","muted","","playsinline","",3,"loadedmetadata"],["video",""],["canvas",""]],template:function(e,t){1&e&&(r.ec(0,u,1,0,"mat-spinner",0),r.Lb(1,"div",1),r.Lb(2,"video",2,3),r.Sb("loadedmetadata",function(){return t.onPlay()}),r.Kb(),r.Jb(4,"canvas",null,4),r.Kb()),2&e&&r.Yb("ngIf",t.loading)},directives:[i.h,c.c],styles:[".video-container[_ngcontent-%COMP%]{position:relative}.video-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%], .video-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{position:absolute;top:0;left:0}"]}),e})()}];let v=(()=>{class e{}return e.\u0275mod=r.Gb({type:e}),e.\u0275inj=r.Fb({factory:function(t){return new(t||e)},imports:[[o.b.forChild(m)],o.b]}),e})(),b=(()=>{class e{}return e.\u0275mod=r.Gb({type:e}),e.\u0275inj=r.Fb({factory:function(t){return new(t||e)},imports:[[i.b,v,c.b]]}),e})()}}]);